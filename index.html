<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Frigo-Chef DZ</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { slate: { 950: '#020617' } },
                    fontFamily: { sans: ['Inter', 'sans-serif'], arabic: ['Cairo', 'sans-serif'] }
                }
            }
        }
    </script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { background-color: #020617; color: #e2e8f0; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .animate-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .pulse-badge { animation: pulse-green 2s infinite; }
        @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 70% { box-shadow: 0 0 0 6px rgba(16, 185, 129, 0); } 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
    </style>
</head>
<body>
    <div id="loader" class="flex h-screen flex-col items-center justify-center text-white bg-slate-950 font-sans p-4 text-center">
        <h1 class="text-2xl font-bold mb-2 text-emerald-500">Frigo-Chef DZ</h1>
        <p class="text-slate-400 animate-pulse">Chargement des modules...</p>
        <div id="error-msg" class="hidden mt-4 text-red-400 text-sm border border-red-900 p-2 rounded bg-red-950/30"></div>
    </div>
    
    <div id="root"></div>

    <script>
        // VÃ©rification prÃ©-lancement pour afficher une erreur claire si internet coupe
        window.onload = function() {
            if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
                const err = document.getElementById('error-msg');
                err.classList.remove('hidden');
                err.innerHTML = "âš ï¸ Erreur : Impossible de charger React.<br>VÃ©rifiez votre connexion internet.";
            } else {
                // Tout est OK, on cache le loader quand React prend le relais
            }
        }
    </script>

    <script type="text/babel">
        // --- 0. SÃ‰CURITÃ‰ & UTILS ---
        const { useState, useMemo, useEffect } = React;

        // Fonction sÃ©curisÃ©e pour LIRE le LocalStorage
        const safeLoad = (key, fallback) => {
            try {
                const item = localStorage.getItem(key);
                if (!item || item === "undefined") return fallback;
                return JSON.parse(item);
            } catch (error) {
                console.warn("Erreur lecture stockage:", error);
                return fallback;
            }
        };

        // Fonction sÃ©curisÃ©e pour Ã‰CRIRE dans le LocalStorage (Ã©vite le crash "Script Error")
        const safeSave = (key, value) => {
            try {
                localStorage.setItem(key, JSON.stringify(value));
            } catch (error) {
                console.warn("Erreur sauvegarde (mÃ©moire pleine ou navigation privÃ©e):", error);
            }
        };

        // --- 1. DONNÃ‰ES INITIALES ---
        const INITIAL_INGREDIENTS = [
            { id: '1', cat: 'legume', fr: 'Tomate', ar: 'Ø·Ù…Ø§Ø·Ù…', en: 'Tomato', img: 'https://images.unsplash.com/photo-1592924357228-91a4daadcfea?w=200' },
            { id: '2', cat: 'legume', fr: 'Oignon', ar: 'Ø¨ØµÙ„', en: 'Onion', img: 'https://images.unsplash.com/photo-1618512496248-a07fe83aa829?w=200' },
            { id: '3', cat: 'legume', fr: 'Pomme de terre', ar: 'Ø¨Ø·Ø§Ø·Ø§', en: 'Potato', img: 'https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=200' },
            { id: '11', cat: 'legume', fr: 'Ail', ar: 'Ø«ÙˆÙ…', en: 'Garlic', img: 'https://images.unsplash.com/photo-1615477210537-f81d9f8e5225?w=200' },
            { id: '4', cat: 'viande', fr: 'Poulet', ar: 'Ø¯Ø¬Ø§Ø¬', en: 'Chicken', img: 'https://images.unsplash.com/photo-1532550907401-a500c9a57435?w=200' },
            { id: '5', cat: 'viande', fr: 'Viande Rouge', ar: 'Ù„Ø­Ù…', en: 'Meat', img: 'https://images.unsplash.com/photo-1603048297172-c92544798d5e?w=200' },
            { id: '6', cat: 'epicerie', fr: 'Farine', ar: 'ÙØ±ÙŠÙ†Ø©', en: 'Flour', img: 'https://images.unsplash.com/photo-1586585571612-47d095e1925e?w=200' },
            { id: '7', cat: 'epicerie', fr: 'Couscous', ar: 'ÙƒØ³ÙƒØ³', en: 'Couscous', img: 'https://images.unsplash.com/photo-1586548688220-3162b70f074a?w=200' },
            { id: '13', cat: 'epicerie', fr: 'Pois chiche', ar: 'Ø­Ù…Øµ', en: 'Chickpeas', img: 'https://images.unsplash.com/photo-1584661848529-6799042c16f0?w=200' },
            { id: '8', cat: 'epice', fr: 'Sel', ar: 'Ù…Ù„Ø­', en: 'Salt', img: 'https://images.unsplash.com/photo-1626131776934-22b62071869e?w=200' },
            { id: '14', cat: 'epice', fr: 'Poivre', ar: 'ÙÙ„ÙÙ„ Ø£Ø³ÙˆØ¯', en: 'Pepper', img: 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200' },
            { id: '9', cat: 'laitage', fr: 'Lait', ar: 'Ø­Ù„ÙŠØ¨', en: 'Milk', img: 'https://images.unsplash.com/photo-1550583724-b2692b85b150?w=200' },
            { id: '10', cat: 'laitage', fr: 'Oeufs', ar: 'Ø¨ÙŠØ¶', en: 'Eggs', img: 'https://images.unsplash.com/photo-1491524062933-cb0289261700?w=200' }
        ];

        const INITIAL_RECIPES = [
            {
                id: 1, type: 'plat', title: { fr: "Couscous Royal", ar: "ÙƒØ³ÙƒØ³ Ù…Ù„ÙƒÙŠ", en: "Royal Couscous" },
                img: "https://images.unsplash.com/photo-1541518763669-27fef04b14ea?w=800", time: "120", calories: "750",
                ingredients: ["1", "3", "4", "7", "11", "13"],
                instructions: { fr: ["Cuire la viande.", "Ajouter les lÃ©gumes.", "Vapeur le couscous."], ar: ["Ø·ÙŠØ¨ÙŠ Ø§Ù„Ù„Ø­Ù….", "Ø²ÙŠØ¯ÙŠ Ø§Ù„Ø®Ø¶Ø±Ø©.", "ÙÙˆØ±ÙŠ Ø§Ù„ÙƒØ³ÙƒØ³."], en: ["Cook meat.", "Add veggies.", "Steam couscous."] }
            },
            {
                id: 2, type: 'plat', title: { fr: "Frites Omelette", ar: "ÙØ±ÙŠØª Ø£ÙˆÙ…Ù„ÙŠØª", en: "Fries Omelet" },
                img: "https://images.unsplash.com/photo-1593584785033-9c7604d0863f?w=800", time: "20", calories: "400",
                ingredients: ["3", "10", "8", "14"],
                instructions: { fr: ["Frire les pommes de terre.", "Battre les oeufs.", "MÃ©langer."], ar: ["Ù‚Ù„ÙŠ Ø§Ù„Ø¨Ø·Ø§Ø·Ø§.", "Ø®Ù„Ø·ÙŠ Ø§Ù„Ø¨ÙŠØ¶.", "Ø®Ù„Ø·ÙŠ ÙƒÙ„Ø´."], en: ["Fry potatoes.", "Beat eggs.", "Mix."] }
            }
        ];

        // --- 2. COMPOSANTS ICONES ---
        const Icon = ({ children, className, onClick }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} onClick={onClick}>{children}</svg>
        );
        
        const Icons = {
            Search: (p) => <Icon {...p}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></Icon>,
            ChefHat: (p) => <Icon {...p}><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"></path><line x1="6" y1="17" x2="18" y2="17"></line></Icon>,
            Heart: (p) => <Icon {...p}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></Icon>,
            ArrowLeft: (p) => <Icon {...p}><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></Icon>,
            Plus: (p) => <Icon {...p}><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></Icon>,
            X: (p) => <Icon {...p}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></Icon>,
            Check: (p) => <Icon {...p}><polyline points="20 6 9 17 4 12"></polyline></Icon>,
            Flame: (p) => <Icon {...p}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></Icon>,
            Settings: (p) => <Icon {...p}><path d="M12.22 2h-.44a2 2 0 0 1-2-2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73v.18a2 2 0 0 0 2 0v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V2.18a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></Icon>,
            Trash: (p) => <Icon {...p}><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></Icon>,
            Edit: (p) => <Icon {...p}><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></Icon>,
            Share: (p) => <Icon {...p}><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></Icon>,
            Fridge: (p) => <Icon {...p}><path d="M5 2h14a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2Z"/><line x1="5" y1="10" x2="19" y2="10"/><path d="M15 2v20"/></Icon>,
            Utensils: (p) => <Icon {...p}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M7 2v20"></path><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"></path></Icon>,
            List: (p) => <Icon {...p}><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></Icon>,
            Globe: (p) => <Icon {...p}><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></Icon>,
            Alert: (p) => <Icon {...p}><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></Icon>
        };

        const CATEGORIES = [
            { id: 'legume', fr: 'LÃ©gumes & Fruits', ar: 'Ø®Ø¶Ø±ÙˆØ§Øª ÙˆÙÙˆØ§ÙƒÙ‡', en: 'Veg & Fruits', icon: 'ğŸ¥•' },
            { id: 'viande', fr: 'Viandes & Poissons', ar: 'Ù„Ø­ÙˆÙ… ÙˆØ£Ø³Ù…Ø§Ùƒ', en: 'Meats & Fish', icon: 'ğŸ¥©' },
            { id: 'epicerie', fr: 'Ã‰picerie & Farines', ar: 'Ø¨Ù‚ÙˆÙ„ÙŠØ§Øª ÙˆÙ…Ø¤ÙˆÙ†Ø©', en: 'Pantry & Flour', icon: 'ğŸŒ¾' },
            { id: 'epice', fr: 'Ã‰pices', ar: 'ØªÙˆØ§Ø¨Ù„', en: 'Spices', icon: 'ğŸŒ¶ï¸' },
            { id: 'laitage', fr
